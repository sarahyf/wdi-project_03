<% if user_signed_in? %>
<form action="">
    <input type="text" name="taskName" id="taskName" placeholder="Task Name">

    <input type="text" name="projectName" id="projectName" placeholder="What is the project">

    <input type="time" name="startTime" id="startTime">
    <input type="time" name="endTime" id="endTime">

   <!-- <input type="submit" name="taskDone" id="taskDone" value="Done"> -->
   <button id="submit">Done</button>
</form>

<!--
   <div id="auto">
        <p id="timer"></p>
        <button id="start_task">Start</button>
   </div>
   -->

    <% tasks_array = [] %>
    <% hours = 0 %>
    <% minutes = 0 %>
    <% seconds = 0  %>

    <% current_user.projects.each do |p| %>
        <% p.tasks.each do |t| %>
        <% tasks_array.push(t) %>
            <% seconds = seconds + (t.duration[6..7]).to_i %>
            <% minutes = minutes + (t.duration[3..4]).to_i %>
            <% hours = hours + (t.duration[0..1]).to_i %>
        <% end %>
    <% end %>

    <% if seconds >= 60 %>
        <% rest = seconds %>
        <% seconds = seconds - 60 %>
        <% rest = rest - seconds %>
        <% minutes = minutes + (rest / 60) %>
    <% end %>

    <% if minutes >= 60 %>
        <% rest = minutes %>
        <% minutes = minutes - 60 %>
        <% rest = rest - minutes %>
        <% hours = hours + (rest / 60) %>
    <% end %>

    <% seconds = "0#{seconds}" if seconds < 10 %>
    <% minutes = "0#{minutes}" if minutes < 10 %>
    <% hours = "0#{hours}" if hours < 10 %>
  

<!--.created_at.strftime "%B %d, %Y" -->
   <% while tasks_array.empty? == false %>

   <div>
   <p><%= tasks_array[0].created_at.strftime "%B %d, %Y" %> &nbsp; &nbsp; &nbsp; <%= "#{hours}:#{minutes}:#{seconds}" %></p>
        <% test = tasks_array[0] %>
        <% check = true %>
        <%= project_name = "" %>
      
      <% while check == true %>

       <% first_element = tasks_array.shift %>

        <% if (first_element.created_at.strftime "%B %d, %Y") == (test.created_at.strftime "%B %d, %Y") %>
            <% current_user.projects.each do |p| %>
                <% project_name = p.name if p.id == first_element.project_id %>
            <% end %>

            <strong><%= first_element.name %> / <%= project_name %></strong>

            <strong>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<%= first_element.start_time.strftime "%I:%M %P" %>-<%= first_element.end_time.strftime "%I:%M %P" %> &nbsp; &nbsp; &nbsp; Duration: <%= first_element.duration %></strong>

            <hr>
            
                <% check = false if tasks_array.empty? %>    
      
        <% else %>
            <% tasks_array.unshift first_element %>
            <% check = false %>
        <% end %>
        <% end %>
        <% end %>
            
   </div>

<% end %>